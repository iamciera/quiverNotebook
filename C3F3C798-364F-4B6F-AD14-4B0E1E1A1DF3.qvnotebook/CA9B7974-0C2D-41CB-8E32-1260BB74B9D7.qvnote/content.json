{
  "title": "Dalliance Making DM6 gene track - Fail",
  "cells": [
    {
      "type": "markdown",
      "data": "### Download .bed file \n\nI am going to start with gene reference track.\n\n[http://genome.ucsc.edu/cgi-bin/hgTables](http://genome.ucsc.edu/cgi-bin/hgTables).  You have many options on what track you like so here are the details I choose:\n\n![Screen Shot 2016-03-08 at 9.32.35 AM.png](quiver-image-url/854EF35310E74ADD72F95F3C361FDCDB.png)\n\nSaved as `dm6_refGenes.bed`.  \n\ntxStart = transcription start\ntxEnd = transcription end\n\n\n### Convert BED to BED12\n\n-  In R using [BED format guide](https://genome.ucsc.edu/FAQ/FAQformat.html#format1), I rearranged the `dm6_refGenes.bed` to be BED12 format. \n-  More information can be found in the [bedtools guide](http://bedtools.readthedocs.org/en/latest/content/general-usage.html). Can only have one entry per gene and exons defined in columns\n\n\n reformatting done in reformatBED.R\n\nNow I need to sort `dm6_BED12.bed` by chromosome.\n\n   sort -k1,1 -k2,2n dm6_BED12.bed > dm6_sorted.bed\n\nThe arguments key:\n\n`-k1,1` First sort by the first column, dictating breaking ties using the value in column 1\n`k2,2n` Then sort by the second column. `n` means sort numerically.\n\n### Convert Bed to bigBed\n\n**Step 1**: Install wget to download tools.\n\nI don't have wget so I installed it with [homebrew](http://brew.sh/). \n\n  `brew install wget`\n\n**Step 2**: Install tools to convert bed to [bigbed](http://genome.ucsc.edu/goldenPath/help/bigBed.html). Place in `~/genomicTools`\n\n      wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.x86_64/fetchChromSizes\n      wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.x86_64/bedToBigBed\n      wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.x86_64/bigBedToBed\n      chmod +x fetchChromSizes bedToBigBed\n      \nNote: I run on a 10.9.5 system the build for the tools I need are either built for 10.10.5 or 10.5, so I rounded up to 10.10.5. \n\n**Step 3**\n\nNow I need to get the ChomSizes. I used `twoBitInfo` the 2bit files to extract this information . \n\nInstall\n\n    wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.x86_64/twoBitInfo\n    chmod +x twoBitInfo\n    \nCommand `twoBitInfo dm6.2bit stdout | sort -k2rn > dm6.chrom.sizes`\n\n**Step 5** Convert to bigBed\n\n  bedToBigBed -extraIndex=name dm6_sorted.bed dm6.chrom.sizes dm6_gene_1.2_BED12.bb\n  \nMaybe I can do the opposite with \n\n\nI _think_ it ran successfully, but when I try to run the track it gives the error on the browser:\n\n    Not supported format, magic=0x0\n\nI must have converted wrong.  I am going to go through the process one more time to see if I can figure out what is going wrong. \n\n**Trouble Shooting**:\n\nI now cannot use the bigBed converting tool I get the error:\n\n`Error line 1 of dm6_sorted.bed: BED blocks must span chromStart to chromEnd.  BED chromStarts[0] = 8116, must be 0 so that (chromStart + chromStarts[0]) equals chromStart.`\n\n1.  I believe this has to do with the two bit info guide and not how I formatted the BED12 file (`dm6_BED12.bed`).  I now need to see what an example `dm6.chrom.sizes` file should look like. \n2.  Another possiblility is that I am using the bedtobigbed command line option wrong. I think this may be the case since according to [example 3](https://genome.ucsc.edu/goldenpath/help/bigBed.html#Ex3), I need to use a `.as` to describe all the headers in BED12 file. Might need to know a little about [autoSql](http://www.linuxjournal.com/article/5949).\n4. Maybe there are regions that don't fit within chromosomes.  In this case I am going to use the `bedclip` option. \n\n\n      wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.x86_64/bedClip\n      chmod +x bedClip\n\n      bedClip dm6_sorted.bed dm6.chrom.sizes dm6_sorted_clip.bed\n\nThis was not the problem. \n\n5. Judging from the error I am getting, `Error line 1 of dm6_sorted_clip.bed: BED blocks must span chromStart to chromEnd.  BED chromStarts[0] = 8116, must be 0 so that (chromStart + chromStarts[0]) equals chromStart.`, the likely explanation is that my block columns (11 and 12) need to start at zero.  \n\nThis sucks I can't seem to get the gene models to work.  I think in the end the file I have is a combination of many problems.  1. The gene models have isoforms, so there is overlapping gene models. 2. the block sizes are not formattedd correctly. 3. \n\nSince I don't even need the gene models I am going to just go ahead and map another track. The Kvon data."
    }
  ]
}